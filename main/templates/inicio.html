{% extends 'index.html' %}
{% load static %}
{% load my_filters %}

{% block encabezado %}
  <h1>SuppInfo</h1>
{% endblock %}

{% block contenido %}
  <div class="carrusel-container-recommended">
    <a class="carrusel-flecha-izquierda-recommended">
      <i class="fas fa-chevron-left"></i> <!-- Ícono de flecha hacia la izquierda para navegar -->
    </a>
    <div class="productos-recomendados-container">
      <h2 class="productos-recomendados-titulo">Productos recomendados</h2>
      <div class="productos-recomendados-card">
      {% for p in productos_recomendados %}
        <div class="producto-recomendado">
          <a href="{% url 'producto_detail' p.id %}" class="producto-enlace">
            <img src="{{ p.imagen.url }}" alt="{{ p.nombre }}" class="producto-imagen">
          </a>
          <div class="producto-info">
            <span class="producto-nombre">{{ p.nombre }}</span>
            <span class="producto-precio">{{ p.precio }}€</span>
            <span class="producto-marca">{{ p.marca.nombre }}</span>
            <div class="producto-rating">
              {% for i in 0|to:4 %}
                  {% with i|add:1 as next %}
                      {% if p.rating_original > i %}
                          {% if p.rating_original < next %}
                              <i class="fas fa-star-half-alt"></i> <!-- Media estrella -->
                          {% else %}
                              <i class="fas fa-star"></i> <!-- Estrella llena -->
                          {% endif %}
                      {% else %}
                          <i class="far fa-star"></i> <!-- Estrella vacía -->
                      {% endif %}
                  {% endwith %}
              {% endfor %}
              {% if p in wishlist %}
                <button class="wishlist-btn" id="wishlist-btn-{{ p.id }}" onclick="removeFromWishlist('{{ p.id }}')">
                  <i class="fas fa-heart" id="wishlist-icon-{{ p.id }}"></i> <!-- Corazón lleno -->
                </button>
              {% else %}
                <button class="wishlist-btn" id="wishlist-btn-{{ p.id }}" onclick="addToWishlist('{{ p.id }}')">
                  <i class="far fa-heart" id="wishlist-icon-{{ p.id }}"></i> <!-- Corazón vacío -->
                </button>
              {% endif %}
            </div>
          </div>
        </div>
      {% endfor %}
      </div>
    </div>
    <a class="carrusel-flecha-derecha-recommended">
      <i class="fas fa-chevron-right"></i> <!-- Ícono de flecha hacia la derecha para navegar -->
    </a>
  </div>

  <div class="carrusels-container">
    <div class="carrusel-container-new-arrivals">
      <a class="carrusel-flecha-izquierda-new-arrival">
        <i class="fas fa-chevron-left"></i>
      </a>
      <div class="productos-new-arrivals-container">
        <h2 class="productos-new-arrivals-titulo">Novedades</h2>
        <div class="productos-new-arrivals-card">
          {% for p in nuevos_productos %}
            <div class="producto-new-arrival">
              <a href="{% url 'producto_detail' p.id %}" class="producto-enlace">
                <img src="{{ p.imagen.url }}" alt="{{ p.nombre }}" class="producto-imagen">
              </a>
              <div class="producto-info">
                <span class="producto-nombre">{{ p.nombre }}</span>
                <span class="producto-precio">{{ p.precio }}€</span>
                <span class="producto-marca">{{ p.marca.nombre }}</span>
                <div class="producto-rating">
                  {% for i in 0|to:4 %}
                    {% with i|add:1 as next %}
                      {% if p.rating_original > i %}
                        {% if p.rating_original < next %}
                          <i class="fas fa-star-half-alt"></i>
                        {% else %}
                          <i class="fas fa-star"></i>
                        {% endif %}
                      {% else %}
                        <i class="far fa-star"></i>
                      {% endif %}
                    {% endwith %}
                  {% endfor %}
                  {% if p in wishlist %}
                    <button class="wishlist-btn" id="wishlist-btn-{{ p.id }}" onclick="removeFromWishlist('{{ p.id }}')">
                      <i class="fas fa-heart" id="wishlist-icon-{{ p.id }}"></i> <!-- Corazón lleno -->
                    </button>
                  {% else %}
                    <button class="wishlist-btn" id="wishlist-btn-{{ p.id }}" onclick="addToWishlist('{{ p.id }}')">
                      <i class="far fa-heart" id="wishlist-icon-{{ p.id }}"></i> <!-- Corazón vacío -->
                    </button>
                  {% endif %}
                </div>
              </div>
            </div>
          {% endfor %}
        </div>
      </div>
      <a class="carrusel-flecha-derecha-new-arrival">
        <i class="fas fa-chevron-right"></i>
      </a>
    </div>
  
    <div class="carrusel-container-best-sellers">
      <div class="productos-best-sellers-container">
        <h2 class="productos-best-sellers-titulo">Mejores Opiniones</h2>
        <div class="productos-best-sellers-card" id="best-sellers-carousel">
          {% for p, r in productos_reviews.items %}
            <div class="producto-best-seller-complete">
              <div class="producto-best-seller">
                <a href="{% url 'producto_detail' p.id %}" class="producto-enlace">
                  <img src="{{ p.imagen.url }}" alt="{{ p.nombre }}" class="producto-imagen-best-seller">
                </a>
                <div class="producto-info">
                  <span class="producto-nombre">{{ p.nombre }}</span>
                  <span class="producto-precio">{{ p.precio }}€</span>
                  <span class="producto-marca">{{ p.marca.nombre }}</span>
                  <div class="producto-rating">
                    {% for i in 0|to:4 %}
                      {% with i|add:1 as next %}
                        {% if p.rating_original > i %}
                          {% if p.rating_original < next %}
                            <i class="fas fa-star-half-alt"></i>
                          {% else %}
                            <i class="fas fa-star"></i>
                          {% endif %}
                        {% else %}
                          <i class="far fa-star"></i>
                        {% endif %}
                      {% endwith %}
                    {% endfor %}
                    {% if p in wishlist %}
                      <button class="wishlist-btn" id="wishlist-btn-{{ p.id }}" onclick="removeFromWishlist('{{ p.id }}')">
                        <i class="fas fa-heart" id="wishlist-icon-{{ p.id }}"></i> <!-- Corazón lleno -->
                      </button>
                    {% else %}
                      <button class="wishlist-btn" id="wishlist-btn-{{ p.id }}" onclick="addToWishlist('{{ p.id }}')">
                        <i class="far fa-heart" id="wishlist-icon-{{ p.id }}"></i> <!-- Corazón vacío -->
                      </button>
                    {% endif %}
                  </div>
                </div>
              </div>
              <div class="producto-best-seller-reviews">
                <h3>Reseñas</h3>
                <div class="producto-best-seller-reviews-container">
                  {% for review in r %}
                    <div class="producto-best-seller-review">
                      <p>"{{review}}"</p>
                    </div>
                  {% endfor %}
                </div>
              </div>
            </div>
          {% endfor %}
        </div>
      </div>
    </div>
  </div>
{% endblock %}